# Tokyo Sports Lottery Bot / 東京スポーツ抽選ボット

このプロジェクトは、**東京都のスポーツ施設の抽選申込み**を自動で行うボットです。
野球のみしか対応していません。
「申し込み数が多くて手作業が大変…」という方に向けて、手順通りに進めれば簡単に使えるようにしています。
パソコンの基本操作ができる方を対象としています。

## 仕様

特定の日付と時間に対して２回同じ日時とグラウンドに対して、申し込みを行います。

日時の指定は、下記のファイルの`TARGET_DATE`と`TARGET_TIME`に値を設定してください。
TARGET_DATEは、M月D日形式で入力してください。(M,Dはともに半角数字)
TARGET_TIME は「１１：００」のように全角で入力してください（抽選申込み画面での時間帯表示が全角のため、それに合わせる必要があります）。
src/config.py

```python

# config.py
DRIVER_PATH = "/usr/local/bin/msedgedriver"

TARGET_DATE = "5月17日"
TARGET_TIME = "１１：００"
```

---

## 🎯 対応環境と注意点

- **対応OS**：Windows のみ  
  ※Mac や Linux でも動作は可能ですが、**動作確認・サポート対象外**です。
- **対応ブラウザ**：Microsoft Edge  
  ※Edge 以外のブラウザでは動作しません。
- **必要なもの**：
  - Windows パソコン
  - インターネット接続
  - `account.csv` ファイル（ログイン情報）

---

## 📃 `account.csv` ファイルの作り方

ボットがログインするための情報を、`account.csv` に記載します。以下の手順で準備してください。

1. メモ帳などで以下の内容を入力：

    ```csv
    id,password,name
    example_id,example_password,example_name
    ```

2. ファイル名を `account.csv` にして保存します。
3. このファイルを、`installer.ps1` や `executer.ps1` があるフォルダに置きます。

> ✅ ヘッダー（id,password,name）は必ず1行目に入れてください。  
> 複数のアカウントを記載することで、順番に申込みを行うことも可能です。

---

## ⚙️ セットアップ手順

プロジェクトをダウンロードする方法は、以下の2通りあります：

1. コマンドを使う方法：

    ```sh
    Invoke-WebRequest -Uri "https://github.com/YamazakiNorihito/tokyo-sports-lottery-bot/archive/refs/heads/main.zip" -OutFile "tokyo-sports-lottery-bot.zip"
    tar -xf tokyo-sports-lottery-bot.zip
    Remove-Item -Recurse -Force .\tokyo-sports-lottery-bot.zip
    ```

2. GitHub の「Code」>「Download ZIP」から手動でダウンロードする方法

---

## 📦 インストール手順（初回のみ）

1. `installer.ps1` を探します。
2. 右クリックして「**PowerShell で実行**」を選びます。
3. 青いウィンドウが開き、自動でインストールが始まります。
4. 終わるまで待てばOKです。ウィンドウは自動で閉じます。

> ⚠️ PowerShell スクリプトを初めて実行する場合、以下の「ファイルのブロック解除」をしてください。

### PowerShell ファイルのブロック解除方法

1. `installer.ps1` を右クリック → 「プロパティ」を選ぶ  
2. 「全般」タブの下に「ブロック解除（セキュリティ）」があれば、チェックを入れて「適用」

---

## ▶️ 実行手順（抽選申込み）

1. `src/config.py`の`TARGET_DATE`と`TARGET_TIME`に値を設定してください。
2. `executer.ps1` を探します。
3. 右クリックして「**PowerShell で実行**」を選びます。
4. 青いウィンドウが開き、ボットが自動でログインし、抽選申込みを行います。
5. 実行が終わると、ウィンドウは自動で閉じます。

---

## ⚠️ 注意事項

- このボットは、**東京都のスポーツ施設の抽選申込み専用**です。
- ログイン情報は `account.csv` に記載されている内容が使われます。
- `src/config.py` 設定ファイルの`DRIVER_PATH`は基本的には編集不要です。

---

## ✅ よくある質問（FAQ）

### Q. 実行が成功したかどうか、どこで判断できますか？

A. PowerShell のウィンドウ（青い画面）が自動的に閉じた場合は、実行が成功しています。  
また、Webブラウザに「申込み完了」と表示されることがあります。

実行中の操作内容は「ログ」として表示され、処理が正しく行われたか確認できます。  
以下は成功したときの例です：

```bash
account_name: hogehoge
指定された日付 5月17日 が見つかりました。
5月17日 の １１：００ をクリックしました。
指定された日付 5月17日 が見つかりました。
5月17日 の １１：００ をクリックしました。
Successfully logged out.
```

---

### Q. ブラウザが開かない／すぐ閉じてしまうのはなぜ？

A. Botは Microsoft Edge ブラウザを自動操作するために「`msedgedriver`」というツールを使います。  
その起動が遅れていたり、申込みサイトが混雑していると、起動してすぐ終了してしまうことがあります。

→ 解決策：もう一度 `executer.ps1` を実行してください。

---

### Q. 抽選結果は確認できますか？

A. このボットは「申込み」だけを行います。  
抽選結果は、東京都の公式サイトでご確認ください。

---

### Q. 何件申込みされたかログで確認できますか？

A. 現時点では、申込み件数が自動でカウントされる機能はありません。  
ですが、実行中のログを見れば、申込みが行われたか確認できます。

---

### Q. 抽選に失敗したアカウントはどこで確認できますか？

A. PowerShell に表示されるログの中で、`account_name:` の後に `Error` と出ていれば、そのアカウントで申込みが失敗したことを意味します。

失敗した場合：

- もう一度 `executer.ps1` を実行してください。
- もしくは手動で申込みする

まれに、1件目の申込みは成功しても、2件目が失敗することがあります。  

```bash
account_name: {hogehoge}
指定された日付 5月17日 が見つかりました。
5月17日 の １１：００ をクリックしました。
指定された日付 5月17日 が見つかりました。
5月17日 の １１：００ をクリックしました。
Successfully logged out.
account_name: {hogehoge3}
Error processing row 3: Alert Text: 施設を選択して下さい。
（以下、エラー詳細は省略）
```

※ エラーの詳細が長く表示されることがありますが、初心者の方は「Error」という単語が出ているかどうかだけを見ておけば問題ありません。
